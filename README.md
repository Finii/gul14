# libgul

The general utility library contains often-used utility functions and types that form the foundation for other libraries and programs. The main fields covered by the library are:


  * String utilities
  * Concurrency Utilities
  * Time Utilities
  * Backports from new standard library extensions

# Building

Clone this repository:

        git clone ssh://git@stash.desy.de:7999/gul/libgul.git
        cd libgul

Use meson to configure the build you want to have. Build directory names can be what you want. If you use directories starting with 'build' they will be ignored by git. Examples:

        meson build
        meson -D tests=false build_without_tests
        meson --prefix=/usr -D buildtype=release build_rel
        meson -D buildtype=release -D unity=on build_rel_unity
        meson -D buildtype=release -D docs=false build_nodocs_rel
        CXX=clang meson build_clang

Afterwards enter you build directory and fire the build process:

        cd build_rel
        ninja
        ninja test
        ninja data/docs
        makeDdeb -D

## Testing

After configuring the build directory one can run all tests by

        ninja test

To generate a coverage report you need to specify ``-D b_coverage=true`` on the meson call for the build configuration. Then after running the tests the coverage report is generated by

        ninja coverage-html

Depending on the installed coverage tool the targets ``coverage-text`` and ``coverage-xml`` might also be there. To generate a coverage report the package ``gcov`` must be installed, and ``lcov/genhtml`` or *(recommended)* ``gcovr`` (>= 3.1) is used to generate the html pages.

## Notes

1. You can list all possible build configuration switches with ``meson configure`` in an existing build directory [1]. This command can also be used to change build configurations after the directory has been created. For example to decrease the warning level after the build directory has already been created: ``meson configure -D warning_level=1`` [1].
2. The configuration to be changed can immediately follow the ``-D`` for example ``-Dwarning_level=1``.
3. You must call ``ninja`` in the build directory before you call ``makeDdeb`` once. The first call sets up the build directory for makeDdeb to run. Afterwards you can always trigger rebuilds by just calling makeDdeb. (The only exception is changes in debian/, run ninja always after you changed a file in debian/.)
4. ``makeDdeb`` has to be called in the build directory of choice, usually with buildtype = release. Note that debian packaging needs the prefix to be set to /usr (see examples above)

[1] Use ``mesonconf`` if your meson is too old.

## Build configuration switches

In addidion to meson's standard switches there are:

    Option Default Value Possible Values Description
    ------ ------------- --------------- -----------
    docs   true          [true, false]   generate documentation via doxygen
    tests  true          [true, false]   generate tests

Overview of maybe useful standard project options:

    Option         Default Value         Description
    ------         -------------         -----------
    prefix         /usr/local            Installation prefix
    libdir         lib/...               Library directory
    includedir     include               Header file directory
    datadir        share                 Data file (Doxygen website) directory

